module lexer;

import std.bigint : BigInt;
import std.algorithm : countUntil, filter, map, join;
import std.string : format;
import std.conv : to;
import std.stdio;


struct Lexer {
	struct Token {
		struct StringLiteral { dstring value; }
		struct CharacterLiteral { dchar value; }
		struct IntegerLiteral { BigInt value; }
		struct FloatLiteral { BigInt mantissa; long exponent; }

		dstring asString;
		ulong position;
		ubyte type;
		union {
			StringLiteral stringLiteral;
			CharacterLiteral characterLiteral;
			IntegerLiteral integerLiteral;
			FloatLiteral floatLiteral;
		}

		enum {
			UNKNOWN = 0,
			END_OF_FILE = 1,
			IDENTIFIER = 2,
			STRING_LITERAL = 3,
			CHARACTER_LITERAL = 4,
			INTEGER_LITERAL = 5,
			FLOAT_LITERAL = 6,
			__LAST_DYNAMIC_TOKEN = 6
		}
		template STATIC(string s) {
			static assert(staticTokens.countUntil(s) != -1);
			enum STATIC = __LAST_DYNAMIC_TOKEN + 1 + staticTokens.countUntil(s);
		}
	}

	dstring code;
	Token currentToken;

	this(dstring code) {
		this.code = code ~ 0;
		popFront();
	}

	private ulong position;
	private ulong[] lineBeginPositions = [ 0 ];

	Token front() { return currentToken; }
	Token moveFront() { return currentToken; }
	bool empty() { return currentToken.type == Token.END_OF_FILE; }

	void popFront() {
		skipWhitespaceLineBreaksAndComments();
		currentToken.position = position;
if(isIdentifierFirstChar(code[position])){if(code[position+0]=='\U00000000'){{lexEofToken;}}else if(code[position+0]=='\U0000003E'){if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`>=`;position+=2;}}}else if(code[position+1]=='\U0000003E'){if(code[position+2]=='\U0000003D'){{if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`>>=`;position+=3;}}}else if(code[position+2]=='\U0000003E'){if(code[position+3]=='\U0000003D'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`>>>=`;position+=4;}}}else {if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`>>>`;position+=3;}}}else {if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`>>`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`>`;position+=1;}}}else if(code[position+0]=='\U0000005D'){{if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`]`;position+=1;}}}else if(code[position+0]=='\U0000007C'){if(code[position+1]=='\U0000007C'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`||`;position+=2;}}}else if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`|=`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`|`;position+=1;}}}else if(code[position+0]=='\U0000003F'){{if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`?`;position+=1;}}}else if(code[position+0]=='\U0000005E'){if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`^=`;position+=2;}}}else if(code[position+1]=='\U0000005E'){if(code[position+2]=='\U0000003D'){{if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`^^=`;position+=3;}}}else {if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`^^`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`^`;position+=1;}}}else if(code[position+0]=='\U0000007D'){{if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`}`;position+=1;}}}else if(code[position+0]=='\U0000005F'){if(code[position+1]=='\U0000005F'){if(code[position+2]=='\U00000044'){if(code[position+3]=='\U00000041'){if(code[position+4]=='\U00000054'){if(code[position+5]=='\U00000045'){if(code[position+6]=='\U0000005F'){if(code[position+7]=='\U0000005F'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`__DATE__`;position+=8;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U0000004C'){if(code[position+3]=='\U00000049'){if(code[position+4]=='\U0000004E'){if(code[position+5]=='\U00000045'){if(code[position+6]=='\U0000005F'){if(code[position+7]=='\U0000005F'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`__LINE__`;position+=8;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U00000070'){if(code[position+3]=='\U00000061'){if(code[position+4]=='\U00000072'){if(code[position+5]=='\U00000061'){if(code[position+6]=='\U0000006D'){if(code[position+7]=='\U00000065'){if(code[position+8]=='\U00000074'){if(code[position+9]=='\U00000065'){if(code[position+10]=='\U00000072'){if(code[position+11]=='\U00000073'){{if (!isIdentifierChar(code[position+12])){currentToken.type=Token.STATIC!`__parameters`;position+=12;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U00000050'){if(code[position+3]=='\U00000052'){if(code[position+4]=='\U00000045'){if(code[position+5]=='\U00000054'){if(code[position+6]=='\U00000054'){if(code[position+7]=='\U00000059'){if(code[position+8]=='\U0000005F'){if(code[position+9]=='\U00000046'){if(code[position+10]=='\U00000055'){if(code[position+11]=='\U0000004E'){if(code[position+12]=='\U00000043'){if(code[position+13]=='\U00000054'){if(code[position+14]=='\U00000049'){if(code[position+15]=='\U0000004F'){if(code[position+16]=='\U0000004E'){if(code[position+17]=='\U0000005F'){if(code[position+18]=='\U0000005F'){{if (!isIdentifierChar(code[position+19])){currentToken.type=Token.STATIC!`__PRETTY_FUNCTION__`;position+=19;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U00000054'){if(code[position+3]=='\U00000049'){if(code[position+4]=='\U0000004D'){if(code[position+5]=='\U00000045'){if(code[position+6]=='\U0000005F'){if(code[position+7]=='\U0000005F'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`__TIME__`;position+=8;}}}else {}}else if(code[position+6]=='\U00000053'){if(code[position+7]=='\U00000054'){if(code[position+8]=='\U00000041'){if(code[position+9]=='\U0000004D'){if(code[position+10]=='\U00000050'){if(code[position+11]=='\U0000005F'){if(code[position+12]=='\U0000005F'){{if (!isIdentifierChar(code[position+13])){currentToken.type=Token.STATIC!`__TIMESTAMP__`;position+=13;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U00000074'){if(code[position+3]=='\U00000072'){if(code[position+4]=='\U00000061'){if(code[position+5]=='\U00000069'){if(code[position+6]=='\U00000074'){if(code[position+7]=='\U00000073'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`__traits`;position+=8;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U00000045'){if(code[position+3]=='\U0000004F'){if(code[position+4]=='\U00000046'){if(code[position+5]=='\U0000005F'){if(code[position+6]=='\U0000005F'){{lexEofToken;}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U0000004D'){if(code[position+3]=='\U0000004F'){if(code[position+4]=='\U00000044'){if(code[position+5]=='\U00000055'){if(code[position+6]=='\U0000004C'){if(code[position+7]=='\U00000045'){if(code[position+8]=='\U0000005F'){if(code[position+9]=='\U0000005F'){{if (!isIdentifierChar(code[position+10])){currentToken.type=Token.STATIC!`__MODULE__`;position+=10;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U00000046'){if(code[position+3]=='\U00000049'){if(code[position+4]=='\U0000004C'){if(code[position+5]=='\U00000045'){if(code[position+6]=='\U0000005F'){if(code[position+7]=='\U0000005F'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`__FILE__`;position+=8;}}}else {}}else {}}else {}}else {}}else if(code[position+3]=='\U00000055'){if(code[position+4]=='\U0000004E'){if(code[position+5]=='\U00000043'){if(code[position+6]=='\U00000054'){if(code[position+7]=='\U00000049'){if(code[position+8]=='\U0000004F'){if(code[position+9]=='\U0000004E'){if(code[position+10]=='\U0000005F'){if(code[position+11]=='\U0000005F'){{if (!isIdentifierChar(code[position+12])){currentToken.type=Token.STATIC!`__FUNCTION__`;position+=12;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U00000076'){if(code[position+3]=='\U00000065'){if(code[position+4]=='\U00000063'){if(code[position+5]=='\U00000074'){if(code[position+6]=='\U0000006F'){if(code[position+7]=='\U00000072'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`__vector`;position+=8;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U00000056'){if(code[position+3]=='\U00000045'){if(code[position+4]=='\U0000004E'){if(code[position+5]=='\U00000044'){if(code[position+6]=='\U0000004F'){if(code[position+7]=='\U00000052'){if(code[position+8]=='\U0000005F'){if(code[position+9]=='\U0000005F'){{if (!isIdentifierChar(code[position+10])){currentToken.type=Token.STATIC!`__VENDOR__`;position+=10;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+4]=='\U00000052'){if(code[position+5]=='\U00000053'){if(code[position+6]=='\U00000049'){if(code[position+7]=='\U0000004F'){if(code[position+8]=='\U0000004E'){if(code[position+9]=='\U0000005F'){if(code[position+10]=='\U0000005F'){{if (!isIdentifierChar(code[position+11])){currentToken.type=Token.STATIC!`__VERSION__`;position+=11;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U00000067'){if(code[position+3]=='\U00000073'){if(code[position+4]=='\U00000068'){if(code[position+5]=='\U00000061'){if(code[position+6]=='\U00000072'){if(code[position+7]=='\U00000065'){if(code[position+8]=='\U00000064'){{if (!isIdentifierChar(code[position+9])){currentToken.type=Token.STATIC!`__gshared`;position+=9;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+0]=='\U00000021'){if(code[position+1]=='\U0000003C'){if(code[position+2]=='\U0000003D'){{if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`!<=`;position+=3;}}}else if(code[position+2]=='\U0000003E'){if(code[position+3]=='\U0000003D'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`!<>=`;position+=4;}}}else {if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`!<>`;position+=3;}}}else {if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`!<`;position+=2;}}}else if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`!=`;position+=2;}}}else if(code[position+1]=='\U0000003E'){if(code[position+2]=='\U0000003D'){{if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`!>=`;position+=3;}}}else {if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`!>`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`!`;position+=1;}}}else if(code[position+0]=='\U00000040'){{if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`@`;position+=1;}}}else if(code[position+0]=='\U0000007E'){if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`~=`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`~`;position+=1;}}}else if(code[position+0]=='\U00000061'){if(code[position+1]=='\U0000006C'){if(code[position+2]=='\U00000069'){if(code[position+3]=='\U00000061'){if(code[position+4]=='\U00000073'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`alias`;position+=5;}}}else {}}else if(code[position+3]=='\U00000067'){if(code[position+4]=='\U0000006E'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`align`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000075'){if(code[position+2]=='\U00000074'){if(code[position+3]=='\U0000006F'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`auto`;position+=4;}}}else {}}else {}}else if(code[position+1]=='\U00000062'){if(code[position+2]=='\U00000073'){if(code[position+3]=='\U00000074'){if(code[position+4]=='\U00000072'){if(code[position+5]=='\U00000061'){if(code[position+6]=='\U00000063'){if(code[position+7]=='\U00000074'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`abstract`;position+=8;}}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U00000073'){if(code[position+2]=='\U0000006D'){{if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`asm`;position+=3;}}}else if(code[position+2]=='\U00000073'){if(code[position+3]=='\U00000065'){if(code[position+4]=='\U00000072'){if(code[position+5]=='\U00000074'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`assert`;position+=6;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+0]=='\U00000024'){{if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`$`;position+=1;}}}else if(code[position+0]=='\U00000062'){if(code[position+1]=='\U00000079'){if(code[position+2]=='\U00000074'){if(code[position+3]=='\U00000065'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`byte`;position+=4;}}}else {}}else {}}else if(code[position+1]=='\U00000072'){if(code[position+2]=='\U00000065'){if(code[position+3]=='\U00000061'){if(code[position+4]=='\U0000006B'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`break`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U0000006F'){if(code[position+2]=='\U00000064'){if(code[position+3]=='\U00000079'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`body`;position+=4;}}}else {}}else if(code[position+2]=='\U0000006F'){if(code[position+3]=='\U0000006C'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`bool`;position+=4;}}}else {}}else {}}else {}}else if(code[position+0]=='\U00000025'){if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`%=`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`%`;position+=1;}}}else if(code[position+0]=='\U00000063'){if(code[position+1]=='\U00000064'){if(code[position+2]=='\U0000006F'){if(code[position+3]=='\U00000075'){if(code[position+4]=='\U00000062'){if(code[position+5]=='\U0000006C'){if(code[position+6]=='\U00000065'){{if (!isIdentifierChar(code[position+7])){currentToken.type=Token.STATIC!`cdouble`;position+=7;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U0000006C'){if(code[position+2]=='\U00000061'){if(code[position+3]=='\U00000073'){if(code[position+4]=='\U00000073'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`class`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000061'){if(code[position+2]=='\U00000074'){if(code[position+3]=='\U00000063'){if(code[position+4]=='\U00000068'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`catch`;position+=5;}}}else {}}else {}}else if(code[position+2]=='\U00000073'){if(code[position+3]=='\U00000074'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`cast`;position+=4;}}}else if(code[position+3]=='\U00000065'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`case`;position+=4;}}}else {}}else {}}else if(code[position+1]=='\U00000065'){if(code[position+2]=='\U0000006E'){if(code[position+3]=='\U00000074'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`cent`;position+=4;}}}else {}}else {}}else if(code[position+1]=='\U00000066'){if(code[position+2]=='\U0000006C'){if(code[position+3]=='\U0000006F'){if(code[position+4]=='\U00000061'){if(code[position+5]=='\U00000074'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`cfloat`;position+=6;}}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U00000072'){if(code[position+2]=='\U00000065'){if(code[position+3]=='\U00000061'){if(code[position+4]=='\U0000006C'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`creal`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U0000006F'){if(code[position+2]=='\U0000006E'){if(code[position+3]=='\U00000074'){if(code[position+4]=='\U00000069'){if(code[position+5]=='\U0000006E'){if(code[position+6]=='\U00000075'){if(code[position+7]=='\U00000065'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`continue`;position+=8;}}}else {}}else {}}else {}}else {}}else if(code[position+3]=='\U00000073'){if(code[position+4]=='\U00000074'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`const`;position+=5;}}}else {}}else {}}else {}}else {}}else if(code[position+0]=='\U00000026'){if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`&=`;position+=2;}}}else if(code[position+1]=='\U00000026'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`&&`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`&`;position+=1;}}}else if(code[position+0]=='\U00000064'){if(code[position+1]=='\U00000065'){if(code[position+2]=='\U0000006C'){if(code[position+3]=='\U00000065'){if(code[position+4]=='\U00000074'){if(code[position+5]=='\U00000065'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`delete`;position+=6;}}}else {}}else if(code[position+4]=='\U00000067'){if(code[position+5]=='\U00000061'){if(code[position+6]=='\U00000074'){if(code[position+7]=='\U00000065'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`delegate`;position+=8;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U00000070'){if(code[position+3]=='\U00000072'){if(code[position+4]=='\U00000065'){if(code[position+5]=='\U00000063'){if(code[position+6]=='\U00000061'){if(code[position+7]=='\U00000074'){if(code[position+8]=='\U00000065'){if(code[position+9]=='\U00000064'){{if (!isIdentifierChar(code[position+10])){currentToken.type=Token.STATIC!`deprecated`;position+=10;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U00000062'){if(code[position+3]=='\U00000075'){if(code[position+4]=='\U00000067'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`debug`;position+=5;}}}else {}}else {}}else if(code[position+2]=='\U00000066'){if(code[position+3]=='\U00000061'){if(code[position+4]=='\U00000075'){if(code[position+5]=='\U0000006C'){if(code[position+6]=='\U00000074'){{if (!isIdentifierChar(code[position+7])){currentToken.type=Token.STATIC!`default`;position+=7;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U00000063'){if(code[position+2]=='\U00000068'){if(code[position+3]=='\U00000061'){if(code[position+4]=='\U00000072'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`dchar`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U0000006F'){if(code[position+2]=='\U00000075'){if(code[position+3]=='\U00000062'){if(code[position+4]=='\U0000006C'){if(code[position+5]=='\U00000065'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`double`;position+=6;}}}else {}}else {}}else {}}else {if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`do`;position+=2;}}}else {}}else if(code[position+0]=='\U00000065'){if(code[position+1]=='\U0000006C'){if(code[position+2]=='\U00000073'){if(code[position+3]=='\U00000065'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`else`;position+=4;}}}else {}}else {}}else if(code[position+1]=='\U00000078'){if(code[position+2]=='\U00000070'){if(code[position+3]=='\U0000006F'){if(code[position+4]=='\U00000072'){if(code[position+5]=='\U00000074'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`export`;position+=6;}}}else {}}else {}}else {}}else if(code[position+2]=='\U00000074'){if(code[position+3]=='\U00000065'){if(code[position+4]=='\U00000072'){if(code[position+5]=='\U0000006E'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`extern`;position+=6;}}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U0000006E'){if(code[position+2]=='\U00000075'){if(code[position+3]=='\U0000006D'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`enum`;position+=4;}}}else {}}else {}}else {}}else if(code[position+0]=='\U00000028'){{if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`(`;position+=1;}}}else if(code[position+0]=='\U00000066'){if(code[position+1]=='\U0000006C'){if(code[position+2]=='\U0000006F'){if(code[position+3]=='\U00000061'){if(code[position+4]=='\U00000074'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`float`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000061'){if(code[position+2]=='\U0000006C'){if(code[position+3]=='\U00000073'){if(code[position+4]=='\U00000065'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`false`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000069'){if(code[position+2]=='\U0000006E'){if(code[position+3]=='\U00000061'){if(code[position+4]=='\U0000006C'){if(code[position+5]=='\U0000006C'){if(code[position+6]=='\U00000079'){{if (!isIdentifierChar(code[position+7])){currentToken.type=Token.STATIC!`finally`;position+=7;}}}else {}}else {if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`final`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000075'){if(code[position+2]=='\U0000006E'){if(code[position+3]=='\U00000063'){if(code[position+4]=='\U00000074'){if(code[position+5]=='\U00000069'){if(code[position+6]=='\U0000006F'){if(code[position+7]=='\U0000006E'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`function`;position+=8;}}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U0000006F'){if(code[position+2]=='\U00000072'){if(code[position+3]=='\U00000065'){if(code[position+4]=='\U00000061'){if(code[position+5]=='\U00000063'){if(code[position+6]=='\U00000068'){if(code[position+7]=='\U0000005F'){if(code[position+8]=='\U00000072'){if(code[position+9]=='\U00000065'){if(code[position+10]=='\U00000076'){if(code[position+11]=='\U00000065'){if(code[position+12]=='\U00000072'){if(code[position+13]=='\U00000073'){if(code[position+14]=='\U00000065'){{if (!isIdentifierChar(code[position+15])){currentToken.type=Token.STATIC!`foreach_reverse`;position+=15;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {if (!isIdentifierChar(code[position+7])){currentToken.type=Token.STATIC!`foreach`;position+=7;}}}else {}}else {}}else {}}else {if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`for`;position+=3;}}}else {}}else {}}else if(code[position+0]=='\U00000029'){{if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`)`;position+=1;}}}else if(code[position+0]=='\U00000067'){if(code[position+1]=='\U0000006F'){if(code[position+2]=='\U00000074'){if(code[position+3]=='\U0000006F'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`goto`;position+=4;}}}else {}}else {}}else {}}else if(code[position+0]=='\U0000002A'){if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`*=`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`*`;position+=1;}}}else if(code[position+0]=='\U0000002B'){if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`+=`;position+=2;}}}else if(code[position+1]=='\U0000002B'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`++`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`+`;position+=1;}}}else if(code[position+0]=='\U00000069'){if(code[position+1]=='\U00000064'){if(code[position+2]=='\U0000006F'){if(code[position+3]=='\U00000075'){if(code[position+4]=='\U00000062'){if(code[position+5]=='\U0000006C'){if(code[position+6]=='\U00000065'){{if (!isIdentifierChar(code[position+7])){currentToken.type=Token.STATIC!`idouble`;position+=7;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U0000006D'){if(code[position+2]=='\U00000070'){if(code[position+3]=='\U0000006F'){if(code[position+4]=='\U00000072'){if(code[position+5]=='\U00000074'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`import`;position+=6;}}}else {}}else {}}else {}}else if(code[position+2]=='\U0000006D'){if(code[position+3]=='\U00000075'){if(code[position+4]=='\U00000074'){if(code[position+5]=='\U00000061'){if(code[position+6]=='\U00000062'){if(code[position+7]=='\U0000006C'){if(code[position+8]=='\U00000065'){{if (!isIdentifierChar(code[position+9])){currentToken.type=Token.STATIC!`immutable`;position+=9;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U00000066'){if(code[position+2]=='\U0000006C'){if(code[position+3]=='\U0000006F'){if(code[position+4]=='\U00000061'){if(code[position+5]=='\U00000074'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`ifloat`;position+=6;}}}else {}}else {}}else {}}else {if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`if`;position+=2;}}}else if(code[position+1]=='\U0000006E'){if(code[position+2]=='\U00000074'){if(code[position+3]=='\U00000065'){if(code[position+4]=='\U00000072'){if(code[position+5]=='\U00000066'){if(code[position+6]=='\U00000061'){if(code[position+7]=='\U00000063'){if(code[position+8]=='\U00000065'){{if (!isIdentifierChar(code[position+9])){currentToken.type=Token.STATIC!`interface`;position+=9;}}}else {}}else {}}else {}}else {}}else {}}else {if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`int`;position+=3;}}}else if(code[position+2]=='\U00000076'){if(code[position+3]=='\U00000061'){if(code[position+4]=='\U00000072'){if(code[position+5]=='\U00000069'){if(code[position+6]=='\U00000061'){if(code[position+7]=='\U0000006E'){if(code[position+8]=='\U00000074'){{if (!isIdentifierChar(code[position+9])){currentToken.type=Token.STATIC!`invariant`;position+=9;}}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U0000006F'){if(code[position+3]=='\U00000075'){if(code[position+4]=='\U00000074'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`inout`;position+=5;}}}else {}}else {}}else {if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`in`;position+=2;}}}else if(code[position+1]=='\U00000072'){if(code[position+2]=='\U00000065'){if(code[position+3]=='\U00000061'){if(code[position+4]=='\U0000006C'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`ireal`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000073'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`is`;position+=2;}}}else {}}else if(code[position+0]=='\U0000002C'){{if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`,`;position+=1;}}}else if(code[position+0]=='\U0000002D'){if(code[position+1]=='\U0000002D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`--`;position+=2;}}}else if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`-=`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`-`;position+=1;}}}else if(code[position+0]=='\U0000002E'){if(code[position+1]=='\U0000002E'){if(code[position+2]=='\U0000002E'){{if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`...`;position+=3;}}}else {if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`..`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`.`;position+=1;}}}else if(code[position+0]=='\U0000006C'){if(code[position+1]=='\U00000061'){if(code[position+2]=='\U0000007A'){if(code[position+3]=='\U00000079'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`lazy`;position+=4;}}}else {}}else {}}else if(code[position+1]=='\U0000006F'){if(code[position+2]=='\U0000006E'){if(code[position+3]=='\U00000067'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`long`;position+=4;}}}else {}}else {}}else {}}else if(code[position+0]=='\U0000002F'){if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`/=`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`/`;position+=1;}}}else if(code[position+0]=='\U0000006D'){if(code[position+1]=='\U00000061'){if(code[position+2]=='\U00000063'){if(code[position+3]=='\U00000072'){if(code[position+4]=='\U0000006F'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`macro`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000069'){if(code[position+2]=='\U00000078'){if(code[position+3]=='\U00000069'){if(code[position+4]=='\U0000006E'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`mixin`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U0000006F'){if(code[position+2]=='\U00000064'){if(code[position+3]=='\U00000075'){if(code[position+4]=='\U0000006C'){if(code[position+5]=='\U00000065'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`module`;position+=6;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+0]=='\U0000006E'){if(code[position+1]=='\U00000065'){if(code[position+2]=='\U00000077'){{if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`new`;position+=3;}}}else {}}else if(code[position+1]=='\U00000075'){if(code[position+2]=='\U0000006C'){if(code[position+3]=='\U0000006C'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`null`;position+=4;}}}else {}}else {}}else if(code[position+1]=='\U0000006F'){if(code[position+2]=='\U00000074'){if(code[position+3]=='\U00000068'){if(code[position+4]=='\U00000072'){if(code[position+5]=='\U0000006F'){if(code[position+6]=='\U00000077'){{if (!isIdentifierChar(code[position+7])){currentToken.type=Token.STATIC!`nothrow`;position+=7;}}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+0]=='\U0000006F'){if(code[position+1]=='\U00000075'){if(code[position+2]=='\U00000074'){{if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`out`;position+=3;}}}else {}}else if(code[position+1]=='\U00000076'){if(code[position+2]=='\U00000065'){if(code[position+3]=='\U00000072'){if(code[position+4]=='\U00000072'){if(code[position+5]=='\U00000069'){if(code[position+6]=='\U00000064'){if(code[position+7]=='\U00000065'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`override`;position+=8;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+0]=='\U00000070'){if(code[position+1]=='\U00000061'){if(code[position+2]=='\U00000063'){if(code[position+3]=='\U0000006B'){if(code[position+4]=='\U00000061'){if(code[position+5]=='\U00000067'){if(code[position+6]=='\U00000065'){{if (!isIdentifierChar(code[position+7])){currentToken.type=Token.STATIC!`package`;position+=7;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U00000075'){if(code[position+2]=='\U00000062'){if(code[position+3]=='\U0000006C'){if(code[position+4]=='\U00000069'){if(code[position+5]=='\U00000063'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`public`;position+=6;}}}else {}}else {}}else {}}else if(code[position+2]=='\U00000072'){if(code[position+3]=='\U00000065'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`pure`;position+=4;}}}else {}}else {}}else if(code[position+1]=='\U00000072'){if(code[position+2]=='\U00000061'){if(code[position+3]=='\U00000067'){if(code[position+4]=='\U0000006D'){if(code[position+5]=='\U00000061'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`pragma`;position+=6;}}}else {}}else {}}else {}}else if(code[position+2]=='\U00000069'){if(code[position+3]=='\U00000076'){if(code[position+4]=='\U00000061'){if(code[position+5]=='\U00000074'){if(code[position+6]=='\U00000065'){{if (!isIdentifierChar(code[position+7])){currentToken.type=Token.STATIC!`private`;position+=7;}}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U0000006F'){if(code[position+3]=='\U00000074'){if(code[position+4]=='\U00000065'){if(code[position+5]=='\U00000063'){if(code[position+6]=='\U00000074'){if(code[position+7]=='\U00000065'){if(code[position+8]=='\U00000064'){{if (!isIdentifierChar(code[position+9])){currentToken.type=Token.STATIC!`protected`;position+=9;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+0]=='\U00000072'){if(code[position+1]=='\U00000065'){if(code[position+2]=='\U00000074'){if(code[position+3]=='\U00000075'){if(code[position+4]=='\U00000072'){if(code[position+5]=='\U0000006E'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`return`;position+=6;}}}else {}}else {}}else {}}else if(code[position+2]=='\U00000061'){if(code[position+3]=='\U0000006C'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`real`;position+=4;}}}else {}}else if(code[position+2]=='\U00000066'){{if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`ref`;position+=3;}}}else {}}else {}}else if(code[position+0]=='\U00000073'){if(code[position+1]=='\U00000068'){if(code[position+2]=='\U00000061'){if(code[position+3]=='\U00000072'){if(code[position+4]=='\U00000065'){if(code[position+5]=='\U00000064'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`shared`;position+=6;}}}else {}}else {}}else {}}else if(code[position+2]=='\U0000006F'){if(code[position+3]=='\U00000072'){if(code[position+4]=='\U00000074'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`short`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000074'){if(code[position+2]=='\U00000061'){if(code[position+3]=='\U00000074'){if(code[position+4]=='\U00000069'){if(code[position+5]=='\U00000063'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`static`;position+=6;}}}else {}}else {}}else {}}else if(code[position+2]=='\U00000072'){if(code[position+3]=='\U00000075'){if(code[position+4]=='\U00000063'){if(code[position+5]=='\U00000074'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`struct`;position+=6;}}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U00000075'){if(code[position+2]=='\U00000070'){if(code[position+3]=='\U00000065'){if(code[position+4]=='\U00000072'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`super`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000079'){if(code[position+2]=='\U0000006E'){if(code[position+3]=='\U00000063'){if(code[position+4]=='\U00000068'){if(code[position+5]=='\U00000072'){if(code[position+6]=='\U0000006F'){if(code[position+7]=='\U0000006E'){if(code[position+8]=='\U00000069'){if(code[position+9]=='\U0000007A'){if(code[position+10]=='\U00000065'){if(code[position+11]=='\U00000064'){{if (!isIdentifierChar(code[position+12])){currentToken.type=Token.STATIC!`synchronized`;position+=12;}}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U00000063'){if(code[position+2]=='\U0000006F'){if(code[position+3]=='\U00000070'){if(code[position+4]=='\U00000065'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`scope`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000077'){if(code[position+2]=='\U00000069'){if(code[position+3]=='\U00000074'){if(code[position+4]=='\U00000063'){if(code[position+5]=='\U00000068'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`switch`;position+=6;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+0]=='\U00000074'){if(code[position+1]=='\U00000068'){if(code[position+2]=='\U00000069'){if(code[position+3]=='\U00000073'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`this`;position+=4;}}}else {}}else if(code[position+2]=='\U00000072'){if(code[position+3]=='\U0000006F'){if(code[position+4]=='\U00000077'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`throw`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000065'){if(code[position+2]=='\U0000006D'){if(code[position+3]=='\U00000070'){if(code[position+4]=='\U0000006C'){if(code[position+5]=='\U00000061'){if(code[position+6]=='\U00000074'){if(code[position+7]=='\U00000065'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`template`;position+=8;}}}else {}}else {}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U00000079'){if(code[position+2]=='\U00000070'){if(code[position+3]=='\U00000065'){if(code[position+4]=='\U00000064'){if(code[position+5]=='\U00000065'){if(code[position+6]=='\U00000066'){{if (!isIdentifierChar(code[position+7])){currentToken.type=Token.STATIC!`typedef`;position+=7;}}}else {}}else {}}else if(code[position+4]=='\U00000069'){if(code[position+5]=='\U00000064'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`typeid`;position+=6;}}}else {}}else if(code[position+4]=='\U0000006F'){if(code[position+5]=='\U00000066'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`typeof`;position+=6;}}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U00000072'){if(code[position+2]=='\U00000075'){if(code[position+3]=='\U00000065'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`true`;position+=4;}}}else {}}else if(code[position+2]=='\U00000079'){{if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`try`;position+=3;}}}else {}}else {}}else if(code[position+0]=='\U00000075'){if(code[position+1]=='\U0000006C'){if(code[position+2]=='\U0000006F'){if(code[position+3]=='\U0000006E'){if(code[position+4]=='\U00000067'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`ulong`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000069'){if(code[position+2]=='\U0000006E'){if(code[position+3]=='\U00000074'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`uint`;position+=4;}}}else {}}else {}}else if(code[position+1]=='\U00000062'){if(code[position+2]=='\U00000079'){if(code[position+3]=='\U00000074'){if(code[position+4]=='\U00000065'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`ubyte`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U0000006E'){if(code[position+2]=='\U00000069'){if(code[position+3]=='\U00000074'){if(code[position+4]=='\U00000074'){if(code[position+5]=='\U00000065'){if(code[position+6]=='\U00000073'){if(code[position+7]=='\U00000074'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`unittest`;position+=8;}}}else {}}else {}}else {}}else {}}else if(code[position+3]=='\U0000006F'){if(code[position+4]=='\U0000006E'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`union`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000063'){if(code[position+2]=='\U00000065'){if(code[position+3]=='\U0000006E'){if(code[position+4]=='\U00000074'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`ucent`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000073'){if(code[position+2]=='\U00000068'){if(code[position+3]=='\U0000006F'){if(code[position+4]=='\U00000072'){if(code[position+5]=='\U00000074'){{if (!isIdentifierChar(code[position+6])){currentToken.type=Token.STATIC!`ushort`;position+=6;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+0]=='\U00000076'){if(code[position+1]=='\U00000065'){if(code[position+2]=='\U00000072'){if(code[position+3]=='\U00000073'){if(code[position+4]=='\U00000069'){if(code[position+5]=='\U0000006F'){if(code[position+6]=='\U0000006E'){{if (!isIdentifierChar(code[position+7])){currentToken.type=Token.STATIC!`version`;position+=7;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U00000069'){if(code[position+2]=='\U00000072'){if(code[position+3]=='\U00000074'){if(code[position+4]=='\U00000075'){if(code[position+5]=='\U00000061'){if(code[position+6]=='\U0000006C'){{if (!isIdentifierChar(code[position+7])){currentToken.type=Token.STATIC!`virtual`;position+=7;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+1]=='\U0000006F'){if(code[position+2]=='\U0000006C'){if(code[position+3]=='\U00000061'){if(code[position+4]=='\U00000074'){if(code[position+5]=='\U00000069'){if(code[position+6]=='\U0000006C'){if(code[position+7]=='\U00000065'){{if (!isIdentifierChar(code[position+8])){currentToken.type=Token.STATIC!`volatile`;position+=8;}}}else {}}else {}}else {}}else {}}else {}}else if(code[position+2]=='\U00000069'){if(code[position+3]=='\U00000064'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`void`;position+=4;}}}else {}}else {}}else {}}else if(code[position+0]=='\U0000001A'){{lexEofToken;}}else if(code[position+0]=='\U00000077'){if(code[position+1]=='\U00000068'){if(code[position+2]=='\U00000069'){if(code[position+3]=='\U0000006C'){if(code[position+4]=='\U00000065'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`while`;position+=5;}}}else {}}else {}}else {}}else if(code[position+1]=='\U00000069'){if(code[position+2]=='\U00000074'){if(code[position+3]=='\U00000068'){{if (!isIdentifierChar(code[position+4])){currentToken.type=Token.STATIC!`with`;position+=4;}}}else {}}else {}}else if(code[position+1]=='\U00000063'){if(code[position+2]=='\U00000068'){if(code[position+3]=='\U00000061'){if(code[position+4]=='\U00000072'){{if (!isIdentifierChar(code[position+5])){currentToken.type=Token.STATIC!`wchar`;position+=5;}}}else {}}else {}}else {}}else {}}else if(code[position+0]=='\U0000003A'){{if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`:`;position+=1;}}}else if(code[position+0]=='\U0000003B'){{if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`;`;position+=1;}}}else if(code[position+0]=='\U0000003C'){if(code[position+1]=='\U0000003C'){if(code[position+2]=='\U0000003D'){{if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`<<=`;position+=3;}}}else {if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`<<`;position+=2;}}}else if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`<=`;position+=2;}}}else if(code[position+1]=='\U0000003E'){if(code[position+2]=='\U0000003D'){{if (!isIdentifierChar(code[position+3])){currentToken.type=Token.STATIC!`<>=`;position+=3;}}}else {if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`<>`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`<`;position+=1;}}}else if(code[position+0]=='\U0000005B'){{if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`[`;position+=1;}}}else if(code[position+0]=='\U0000003D'){if(code[position+1]=='\U0000003D'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`==`;position+=2;}}}else if(code[position+1]=='\U0000003E'){{if (!isIdentifierChar(code[position+2])){currentToken.type=Token.STATIC!`=>`;position+=2;}}}else {if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`=`;position+=1;}}}else if(code[position+0]=='\U0000007B'){{if (!isIdentifierChar(code[position+1])){currentToken.type=Token.STATIC!`{`;position+=1;}}}else {}}else{{}}
		//mixin(generateLexerCode);
		currentToken.asString = code[currentToken.position .. position];
	}

	int opApply(int delegate(Token) f) {
		return opApply((index, token) => f(token));
	}

	int opApply(int delegate(size_t, Token) f) {
		int i = 0;
		int result = 0;
		while (!empty()) {
			result = f(i, front());
			if (result) break;
			popFront();
			i++;
		}
		return result;
	}


	unittest {
		writeln(generateLexerCode);
	}


	private static dstring generateLexerCode() {
		return generateCode(
			staticTokens,
			[
				["\u0000", "\u001A", "__EOF__"]: "lexEofToken;",
				//["`"]: "lexAlternateWysiwygStringLiteral;",
				//[`"`]: "lexDoubleQuotedStringLiteral;",
				//[`r"`]: "lexWysiwygStringLiteral;",
				//[`x"`]: "lexHexStringLiteral;",
				//[`q"`]: "lexDelimitedStringLiteral;",
				//["q{"]: "lexTokenStringLiteral;",
				//["'"]: "lexSingleQuotedCharacterLiteral;",
				//["0b", "0B"]: "lexBinaryNumberLiteral;",
				//["0x", "0X"]: "lexHexNumberLiteral;",
				//["0", "1", "2", "3", "4", "5", "6", "7", "8", "9"]: "lexDecimalNumberLiteral;",
				//["#"]: "lexSpecialTokenSequence;",
			]
		);
	}

	private struct Rule {
		dstring code;
		Rule[dchar] choices;

		void insert(dstring charSequence, dstring code) {
			if (charSequence.length == 0) {
				this.code = code;
			} else {
				if (charSequence[0] !in choices) choices[charSequence[0]] = Rule();
				choices[charSequence[0]].insert(charSequence[1..$], code);
			}
		}

		dstring generateCode(int depth = 0) {
			dstring result = "";
			foreach (key, value; choices) {
				result ~= to!dstring(format("if(code[position+%d]=='\\U%08X'){%s}else ",
						depth, key, choices[to!dchar(key)].generateCode(depth+1)));
			}
			return result ~ "{" ~ code ~ "}";
		}
	}

	private static dstring generateCode(dstring[] staticTokens, dstring[dstring[]] lexRules) {
		Rule identifiersAndKeywords;
		Rule operatorsAndLiterals;

		void add(dstring charSequence, dstring code) {
			if (isIdentifierFirstChar(charSequence[0])) {
				identifiersAndKeywords.insert(charSequence, code);
			} else {
				identifiersAndKeywords.insert(charSequence, code);
			}
		}

		foreach (charSequences, code; lexRules) {
			foreach (charSequence; charSequences) {
				add(charSequence, code);
			}
		}
		foreach (charSequence; staticTokens) {
			add(
				charSequence,
				to!dstring(format(
					"if (!isIdentifierChar(code[position+%d])){" ~
						"currentToken.type=Token.STATIC!`%s`;" ~
						"position+=%d;" ~
						// TODO: break;
					"}",
					charSequence.length, charSequence, charSequence.length
				))
			);
		}

		return
			"if(isIdentifierFirstChar(code[position])){" ~
				identifiersAndKeywords.generateCode ~
			"}else{" ~
				operatorsAndLiterals.generateCode ~
			"}";
	}

	private static void lexEofToken() {

	}

	private void parseZeroIntegerLiteral() {
		currentToken.type = Token.INTEGER_LITERAL;
		currentToken.integerLiteral.value = 0;
		position++;
	}

	private void skipWhitespaceLineBreaksAndComments() {
	}

	private static bool isIdentifierChar(dchar c) {
		return isIdentifierFirstChar(c) || ((c >= '0') && (c <= '9'));
	}

	private static bool isIdentifierFirstChar(dchar c) {
		return ((c >= 'a') && (c <= 'z')) || ((c >= 'a') && (c <= 'z')) || (c == '_');
	}

	private static bool isNotIdentifierFirstChar(dchar c) {
		return !isIdentifierFirstChar(c);
	}

	private enum staticTokens = [
		",", ".", "..", "...", "/", "/=", "!", "!<", "!<=", "!<>", "!<>=", "!=",
		"!>", "!>=", "$", "%", "%=", "&", "&&", "&=", "(", ")", "*", "*=", "+", "++",
		"+=", "-", "--", "-=", ":", ";", "<", "<<", "<<=", "<=", "<>", "<>=", "=",
		"==", "=>", ">", ">=", ">>", ">>=", ">>>", ">>>=", "?", "@", "[", "]", "^",
		"^=", "^^", "^^=", "{", "|", "|=", "||", "}", "~", "~=",
		"abstract", "alias", "align", "asm", "assert", "auto", "body", "bool",
		"break", "byte", "case", "cast", "catch", "cdouble", "cent", "cfloat",
		"dchar", "class", "const", "continue", "creal", "dchar", "debug", "default",
		"delegate", "delete", "deprecated", "do", "double", "else", "enum",
		"export", "extern", "false", "final", "finally", "float", "for", "foreach",
		"foreach_reverse", "function", "goto", "idouble", "if", "ifloat",
		"immutable", "import", "in", "inout", "int", "interface", "invariant",
		"ireal", "is", "lazy", "long", "macro", "mixin", "module", "new", "nothrow",
		"null", "out", "override", "package", "pragma", "private", "protected",
		"public", "pure", "real", "ref", "return", "scope", "shared", "short",
		"static", "struct", "super", "switch", "synchronized", "template", "this",
		"throw", "true", "try", "typedef", "typeid", "typeof", "ubyte", "ucent",
		"uint", "ulong", "union", "unittest", "ushort", "version", "virtual", "void",
		"volatile", "wchar", "while", "with", "__DATE__"/*, "__EOF__"*/, "__FILE__",
		"__FUNCTION__", "__gshared", "__LINE__", "__MODULE__", "__parameters",
		"__PRETTY_FUNCTION__", "__TIME__", "__TIMESTAMP__", "__traits", "__vector",
		"__VENDOR__", "__VERSION__"
	];
}


unittest {
	writeln(Lexer.Token.FLOAT_LITERAL);
	writeln(Lexer.Token.STATIC!",");
	writeln(Lexer.Token.STATIC!"__VERSION__");
}

unittest {
	auto lexer = new Lexer("abstract");
	writeln(lexer.currentToken.type);
	writeln(Lexer.Token.STATIC!"abstract");
}
